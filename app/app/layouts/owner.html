<link rel="stylesheet" type="text/css" href="assets/css/owner-main.css" />
<!-- <<<<<<<<<<<<<<<<<<<<<<<New Code>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>-->
<div layout="column" flex style="position:relative;min-height:100%;">
    <header class="main__header" style="position: fixed;width:100%;    z-index: 99;">
        <nav class="air_d_header air_d_2019">
            <div class="aire_d_bar">
                <div class="aire_d_bar_inner">
                    <button class="menu_toggler mobile_btn d-block d-sm-block d-md-block d-lg-none d-xl-none" ng-click="toggleOwnerLeftSidenav()" id="mobileBtn">
                        <span><i class="fas fa-bars"></i></span>
                    </button>
                    <!-- <button class="mobile_btn_close d-block d-sm-block d-md-block d-lg-none d-xl-none" id="closeBtn">
                        <span><i class="fas fa-times"></i></span>
                    </button> -->
                    <a href="#/owner/{{clientSlug}}/feeds" class="air_d_logo">
                        <img src="assets/images/logoamerica.png" alt="logo" width="140px" />
                    </a>
                </div>
                <div class="aire_d_sub">
            
                    <!-- <ul class="air_d__sub-nav air_main_menu" style="margin-right:10px">
                        <li class="s-depth1-wrap"><a ng-href="#/metro" class="s-btn-toggler">Metro</a></li>
                    </ul> -->
                    <ul class="air_d__utility">
                        
                        <div class="dropdown s_login">
                            <button type="button" class=" saved_campaign dropdown-toggle d-none d-sm-none d-md-block" data-toggle="dropdown">
                                saved campaign({{ownerNotifs.length}})
                            </button>
                            <div class="dropdown-menu dropdown-menu-right" style="width: 180px;">
                                <div class="notification_header ">
                                    <h3 class="text_color">You have {{ownerNotifs.length}} Campaigns</h3>
                                </div>
                                <div ng-repeat="activeUserCampaign in ownerNotifs.slice(0, 3)">
                                    <a ng-href="#/owner/{{clientSlug}}/campaign-details/{{activeUserCampaign.id}}">
                                    <div class="notification_desc pl-3">
                                        <p>{{activeUserCampaign.name}}</p>
                                    </div>
                                    <div class="clearfix"></div>
                                </a>
                            </div>
                                <div class="notification_bottom"> <a ng-href="#/owner/{{clientSlug}}/saved-campaigns"> See all campaigns</a> </div>

                            </div>
                        </div>
                        <div class="dropdown s_login">
                            <button type="button" class="dropdown-toggle bell_icon" data-toggle="dropdown">
                                <span class="s-ico-login" style="color: #000"><i class="fa fa-bell"
                                    aria-hidden="true"></i><span class="badge blue"id="notification-count">0</span></span>
                            </button>
							
                            <div class="dropdown-menu dropdown-menu-right" style="width: 190px;">
                                <div class="notification_header">
                                    <h3 class="" style="font-size:12px"><b>You have <span id="notification1-count">0</span> new notification</b></h3>
                                </div>
                                <div id="notification-id-0"></div>
                                <div id="notification-id-1"></div>
                                <div id="notification-id-2"></div>
                                <div class="notification_bottom"  >
                                    <a ng-href="#/owner/{{clientSlug}}/owner-notifications">See all notifications</a>
                                </div>
                            </div>
                        </div>
                        <div class="dropdown s_login">
                            <button type="button" class=" fst_letter dropdown-toggle" data-toggle="dropdown">
                                {{loggedInUser.firstName.slice(0, 1)}}
                            </button>
                            <div class="dropdown-menu dropdown-menu-right" style="padding:10px 0  20px">
                                <a class="dropdown-item" ng-href="#/profile">{{loggedInUser.firstName}} {{loggedInUser.lastName}}</a> 
                                <a class="dropdown-item" ng-href="#/owner/{{clientSlug}}/campaigns"> Campaigns</a>
                                <a class="dropdown-item" ng-href="#/owner/{{clientSlug}}/payments"> Payments</a>
                                <a class="dropdown-item" ng-href="#/location"> Switch view</a>
                                <a class="d-block d-sm-block d-md-none dropdown-item" ng-href="#/owner/{{clientSlug}}/saved-campaigns">Saved Campaign</a>
                                <a class="dropdown-item" ng-href="#/reset_password" style="margin-bottom:15px"> Change Password</a>
                                <a ng-click="logout()" class="logout_color" style="    margin: 0 0 0 18px;"> Logout</a>
                            </div>
                        </div>
                    </ul>
                    <div class=""></div>
                </div>
            </div>
        </nav>
    </header>
    <!--toolbar end -->
    <!-- sidenav start -->
    <div layout="row" flex style="position:relative;">
        <md-sidenav class="md-sidenav-left owner__sidenav scrollbar__style md-whiteframe-z2" md-component-id="ownerLeftSidenav"
                    md-is-locked-open="$mdMedia('min-width: 991px')" style="width: 180px;background: #44596D !important;height:100vh;position: fixed;margin-top: 65px;">
            <!-- <md-toolbar  style="min-height: 65px !important;">
                                                    <img class="png-icon" src="assets/images/billboards.png">
                                    </md-toolbar>  -->
            <header style="min-height:55px !important" class="contbg">
                <md-button aria-label="" ng-href="#owner/home" md-no-ink style="background:transparent" class="logo">
                    <img ng-src="assets/images/owner/owner_logo.png" width="140" alt="owner logo">
                </md-button>
            </header>
            <!-- <md-divider></md-divider> -->
            <md-content class="sidenav-content" style="background: #44596D !important">
                <div>
                    <div style="width: 100% !important;">
                        <md-list class="owners-menu">

                            <md-menu-item class="nv-nav-item">
                                <md-button class="side_navlist" ng-href="#/owner/{{clientSlug}}/feeds" ng-class="{'active-link': currStateName == 'owner.feeds'}"
                                           ng-click="closeMenuSidenavIfMobile()">
                                    To-Do List
                                </md-button>
                            </md-menu-item>
                            <!-- <md-menu-item class="nv-nav-item">
                                            <md-button ng-href="#/owner/{{clientSlug}}/campaigns" ng-class="{'active-link': currStateName == 'owner.campaigns'}"  ng-click="closeMenuSidenavIfMobile()">
                                                    Campaigns
                                            </md-button>
                                    </md-menu-item> -->
                            <!-- campagin start -->
                            <md-menu-item flex layout="column">
                                <md-button aria-expanded="flase" ng-click="toogelCampagin()" class="md-button-toggle">
                                    <div layout="row">
                                        <span style="color:#fff">Campaigns</span>
                                        <span flex></span>
                                        <span>
                                            <md-icon md-svg-src="assets/images/core/ic_keyboard_arrow_down_white_24px.svg" ng-hide="showCampagin"></md-icon>
                                            <md-icon md-svg-src="assets/images/core/ic_keyboard_arrow_up_white_24px.svg" ng-show="showCampagin"></md-icon>
                                        </span>
                                    </div>
                                </md-button>
                            </md-menu-item>
                            <md-menu-item flex layout="column" ng-show="showCampagin">
                                <md-button class="side_navlist" ng-href="#/owner/{{clientSlug}}/campaigns" ng-class="{'active-link': currStateName == 'owner.campaigns'}"
                                           ng-click="changeRequest(); closeMenuSidenavIfMobile()">
                                    <div layout="row">
                                        <span flex="15"></span>
                                        </span>My Campaigns</div>
                                </md-button>
                            </md-menu-item>
                            <md-menu-item flex layout="column" ng-show="showCampagin">
                                <md-button class="side_navlist" ng-href="#/owner/{{clientSlug}}/bba-campaigns" ng-class="{'active-link': currStateName == 'owner.bbi-campaigns'}"
                                           ng-click="changeRequest(); closeMenuSidenavIfMobile()">
                                    <div layout="row">
                                        <span flex="15"></span>
                                        BBA Campaigns
                                    </div>
                                </md-button>
                            </md-menu-item>

                            <!--campagin end-->
                            <md-menu-item class="nv-nav-item">
                                <md-button class="side_navlist" ng-href="#/owner/{{clientSlug}}/requested-hoardings" ng-class="{'active-link': currStateName == 'owner.requested-hoardings'}"
                                           ng-click="changeRequest(); closeMenuSidenavIfMobile()">
                                    Request Inventory
                                </md-button>
                            </md-menu-item>
                            <md-menu-item class="nv-nav-item">
                                <md-button class="side_navlist" ng-href="#/owner/{{clientSlug}}/hoarding-list" ng-class="{'active-link': currStateName == 'owner.hoarding-list'}"
                                           ng-click="changeHoardingList(); closeMenuSidenavIfMobile()">
                                    Inventory List
                                </md-button>
                            </md-menu-item>

                            <md-menu-item class="nv-nav-item">
                                <md-button class="side_navlist" ng-href="#/owner/{{clientSlug}}/payments" ng-class="{'active-link': currStateName == 'owner.payments'}"
                                           ng-click="closeMenuSidenavIfMobile()">
                                    Payments
                                </md-button>
                            </md-menu-item>
                            <md-menu-item class="nv-nav-item">
                                <md-button class="side_navlist" ng-href="#/owner/{{clientSlug}}/bbisupport" ng-class="{'active-link': currStateName == 'owner.bbisupport'}"
                                           ng-click="closeMenuSidenavIfMobile()">
                                    BBA Support
                                </md-button>
                            </md-menu-item>
                            <!-- <md-menu-item class="nv-nav-item">
                                                    <md-button class="side_navlist" ng-href="#/owner/{{clientSlug}}/loginpage" ng-class="{'active-link': currStateName == 'owner.loginpage'}" ng-click="closeMenuSidenavIfMobile()">
                                                            Login Pages
                                                    </md-button>
                                            </md-menu-item> -->
                            <!-- <md-menu-item class="nv-nav-item">
                                            <md-button ng-href="#/owner/{{clientSlug}}/teamPage" ng-class="{'active-link': currStateName == 'owner.teamPage'}" ng-click="">
                                                    <md-icon class="md-default-theme" class="material-icons">&#xE7FB;</md-icon>
                                                    Team
                                            </md-button>
                                    </md-menu-item> -->

                        </md-list>
                    </div>
                </div>
            </md-content>
        </md-sidenav>
        <ui-view class="main_view" flex></ui-view>
        <div layout="column" layout-align="center center" style="position:absolute; bottom: 0px;width: 100%;background: #CCC">
            <div style="padding: 5px 0;">Powered by BBI Advertising Pvt Ltd</div>
        </div>
    </div>
</div>
<script>
        var i = 1;
        var user = localStorage.getItem("loggedInUser");
        var parsedData = JSON.parse(user);
        var user_type = parsedData.user_type;
        if (user_type == 'bbi') {
            var user_id = '-superAdmin';
        } else if (user_type == 'basic') {
            var user_id = parsedData.user_id;
        } else if (user_type == 'owner') {
            var user_id = '-' + parsedData.mong_id;
        }
        var arrayText = [];
        // Enable pusher logging - don't include this in production
        Pusher.logToConsole = true;

        var pusher = new Pusher('83e8ffcc55e67dd5625d', {
            cluster: 'ap2',
            forceTLS: true
        });
        var channel = pusher.subscribe('CampaignLaunch' + user_id);
        var channel1 = pusher.subscribe('campaignClosed' + user_id);
        var channel2 = pusher.subscribe('CampaignLaunchRequested' + user_id);
        var channel3 = pusher.subscribe('CampaignQuoteProvided' + user_id);
        var channel4 = pusher.subscribe('CampaignQuoteRequested' + user_id);
        var channel5 = pusher.subscribe('CampaignQuoteRevision' + user_id);
        var channel6 = pusher.subscribe('CampaignSuggestionRequest' + user_id);
        var channel7 = pusher.subscribe('CampaignSuspended' + user_id);
        var channel8 = pusher.subscribe('ProductApproved' + user_id);
        var channel9 = pusher.subscribe('ProductRequested' + user_id);
        var channel10 = pusher.subscribe('metroCampaignClosed' + user_id);
        var channel11 = pusher.subscribe('metroCampaignLaunched' + user_id);
        var channel12 = pusher.subscribe('metroCampignLocked' + user_id);

        channel.bind('CampaignLaunchEvent', function (data) {
            arrayText.push(data);
            /* $('#notification-count').html(arrayText.length);
             $('#notification1-count').html(arrayText.length);*/
            notificationText(arrayText);

        });
        channel1.bind('campaignClosedEvent', function (data) {
            arrayText.push(data);
            notificationText(arrayText);
        });
        channel2.bind('CampaignLaunchRequestedEvent', function (data) {
            arrayText.push(data);
            notificationText(arrayText);
        });
        channel3.bind('CampaignQuoteProvidedEvent', function (data) {
            arrayText.push(data);
            notificationText(arrayText);
        });
        channel4.bind('CampaignQuoteRequestedEvent', function (data) {
            arrayText.push(data);
            notificationText(arrayText);
        });
        channel5.bind('CampaignQuoteRevisionEvent', function (data) {
            arrayText.push(data);
            notificationText(arrayText)
        });
        channel6.bind('CampaignSuggestionRequestEvent', function (data) {
            arrayText.push(data);
            notificationText(arrayText);
        });
        channel7.bind('CampaignSuspendedEvent', function (data) {
            arrayText.push(data);
            notificationText(arrayText);
        });
        channel8.bind('ProductApprovedEvent', function (data) {
            arrayText.push(data);
            notificationText(arrayText);
        });
        channel9.bind('ProductRequestedEvent', function (data) {
            arrayText.push(data);
            notificationText(arrayText);
        });
        channel10.bind('metroCampaignClosedEvent', function (data) {
            arrayText.push(data);
            notificationText(arrayText);
        });
        channel11.bind('metroCampaignLaunchedEvent', function (data) {
            arrayText.push(data);
            notificationText(arrayText);
        });
        channel12.bind('metroCampignLockedEvent', function (data) {
            arrayText.push(data);
            notificationText(arrayText);
        });

        function notificationText(arrayText) {
            $('#notification-count').html(arrayText.length);
            $('#notification1-count').html(arrayText.length);
            arrayText.forEach(function (element) {
                var j = i % 3;
                $('#notification-id-' + j).html('<div class ="notification_desc md-whiteframe-2dp pl-3"><p>' + element.desc + '</p></div>');
                i++;
            });
        }
    </script>